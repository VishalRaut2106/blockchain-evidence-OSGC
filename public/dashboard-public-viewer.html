<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëÅÔ∏è Public Viewer Dashboard - Evid-DGC</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>">
</head>
<body>
    <!-- Floating Particles Background -->
    <div class="particles" id="particles"></div>
    <!-- Navigation -->
    <nav class="dashboard-nav">
        <div class="container">
            <div class="nav-content">
                <a href="index.html" class="nav-brand">üîê EVID-DGC</a>
                <div class="nav-items">
                    <span class="badge badge-public">üëÅÔ∏è Public Viewer</span>
                    <span id="userWallet" class="wallet-display"></span>
                    <button class="btn btn-outline btn-sm" onclick="window.location.href='index.html'">üö™ Exit</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="dashboard-hero">
        <div class="container">
            <h1>üëÅÔ∏è Public Evidence Portal</h1>
            <p>üåü Access publicly released legal cases and evidence with full transparency üåü</p>
            <div class="hero-stats">
                <div class="hero-stat">
                    <span class="stat-icon">üìä</span>
                    <span class="stat-text">Real-time Data</span>
                </div>
                <div class="hero-stat">
                    <span class="stat-icon">üîí</span>
                    <span class="stat-text">Blockchain Verified</span>
                </div>
                <div class="hero-stat">
                    <span class="stat-icon">üåê</span>
                    <span class="stat-text">IPFS Storage</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Statistics Cards -->
        <div class="grid grid-cols-3 mb-8">
            <div class="card stats-card">
                <div class="stats-number" id="publicCasesCount">0</div>
                <div class="stats-label">Public Cases</div>
            </div>
            <div class="card stats-card">
                <div class="stats-number" id="publicEvidenceCount">0</div>
                <div class="stats-label">Public Evidence</div>
            </div>
            <div class="card stats-card">
                <div class="stats-number" id="totalCommentsCount">0</div>
                <div class="stats-label">Total Comments</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <ul class="tab-list">
                <li><button class="tab-button active" data-tab="cases">Released Cases</button></li>
                <li><button class="tab-button" data-tab="evidence">Released Evidence</button></li>
                <li><button class="tab-button" data-tab="search">Search</button></li>
                <li><button class="tab-button" data-tab="about">About</button></li>
            </ul>
        </div>

        <!-- Cases Tab -->
        <div id="cases" class="tab-content active">
            <div class="flex justify-between items-center mb-6">
                <h2>Publicly Released Cases</h2>
                <div class="flex gap-4">
                    <input type="text" id="caseFilter" class="form-input" placeholder="Filter cases..." style="width: 300px;">
                    <button id="refreshCases" class="btn btn-outline">üîÑ Refresh</button>
                </div>
            </div>
            <div id="casesContainer" class="grid gap-4">
                <div class="text-center p-8">
                    <div class="loading mb-4"></div>
                    <p>Loading public cases...</p>
                </div>
            </div>
        </div>

        <!-- Evidence Tab -->
        <div id="evidence" class="tab-content">
            <div class="flex justify-between items-center mb-6">
                <h2>Evidence Management</h2>
                <button class="btn btn-primary" onclick="showEvidenceForm()">üìÅ Submit Evidence</button>
            </div>
            
            <!-- Evidence Submission Form -->
            <div id="evidenceFormContainer" class="card hidden">
                <h3>Submit New Evidence</h3>
                <form id="evidenceForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="caseId">Case ID</label>
                            <input type="text" id="caseId" name="caseId" class="form-control" placeholder="Enter case ID" required>
                        </div>
                        <div class="form-group">
                            <label for="title">Evidence Title</label>
                            <input type="text" id="title" name="title" class="form-control" placeholder="Enter evidence title" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" class="form-control" placeholder="Describe the evidence" required></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="type">Evidence Type</label>
                            <select id="type" name="type" class="form-control" required>
                                <option value="">Select type</option>
                                <option value="Physical">Physical Evidence</option>
                                <option value="Digital">Digital Evidence</option>
                                <option value="Document">Document</option>
                                <option value="Photo">Photograph</option>
                                <option value="Video">Video</option>
                                <option value="Audio">Audio</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="evidenceFile">Upload File</label>
                            <input type="file" id="evidenceFile" class="form-control" required>
                        </div>
                    </div>
                    <div id="fileInfo" class="mb-4"></div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success">Submit Evidence</button>
                        <button type="button" class="btn btn-outline" onclick="hideEvidenceForm()">Cancel</button>
                    </div>
                </form>
            </div>
            
            <!-- Evidence List -->
            <div id="evidenceList" class="mt-6">
                <div class="text-center p-8">
                    <div class="loading mb-4"></div>
                    <p>Loading evidence...</p>
                </div>
            </div>
        </div>

        <!-- Search Tab -->
        <div id="search" class="tab-content">
            <div class="card">
                <h2>Search by ID</h2>
                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <h3>Search Case</h3>
                        <div class="form-group">
                            <input type="text" id="searchCaseId" class="form-input" placeholder="Enter Case Number">
                        </div>
                        <button id="searchCaseBtn" class="btn btn-primary">Search Case</button>
                    </div>
                    <div>
                        <h3>Search Evidence</h3>
                        <div class="form-group">
                            <input type="text" id="searchEvidenceId" class="form-input" placeholder="Enter Evidence ID">
                        </div>
                        <button id="searchEvidenceBtn" class="btn btn-primary">Search Evidence</button>
                    </div>
                </div>
                <div id="searchResults" class="mt-6"></div>
            </div>
        </div>

        <!-- About Tab -->
        <div id="about" class="tab-content">
            <div class="card">
                <h2>About Public Access</h2>
                <div class="grid gap-6">
                    <div>
                        <h3>üîì What You Can Access</h3>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Cases that have been officially released to the public</li>
                            <li>Evidence items that court officials have made publicly available</li>
                            <li>Download public evidence files from IPFS</li>
                            <li>Add comments and engage in public discussion</li>
                            <li>Search for specific cases or evidence by ID</li>
                        </ul>
                    </div>
                    <div>
                        <h3>üîí Privacy & Security</h3>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Only officially released items are visible to public viewers</li>
                            <li>All evidence is stored securely on IPFS with blockchain verification</li>
                            <li>Chain of custody is maintained and verifiable</li>
                            <li>Your comments are permanently recorded on the blockchain</li>
                        </ul>
                    </div>
                    <div>
                        <h3>‚öñÔ∏è Legal Notice</h3>
                        <p class="text-sm text-muted">
                            This system provides access to legal evidence that has been officially released to the public. 
                            All information is provided for transparency and public interest. Users should respect the 
                            legal nature of this content and use it responsibly.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Case Details Modal -->
    <div id="caseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalCaseTitle">Case Details</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div id="modalCaseContent">
                <!-- Case details will be loaded here -->
            </div>
            <div class="comments-section">
                <h3>Public Comments</h3>
                <div id="caseComments"></div>
                <div class="form-group mt-4">
                    <textarea id="newCaseComment" class="form-textarea" placeholder="Add a public comment..."></textarea>
                </div>
                <button id="addCaseComment" class="btn btn-primary">Add Comment</button>
            </div>
        </div>
    </div>

    <!-- Evidence Details Modal -->
    <div id="evidenceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalEvidenceTitle">Evidence Details</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div id="modalEvidenceContent">
                <!-- Evidence details will be loaded here -->
            </div>
            <div class="comments-section">
                <h3>Public Comments</h3>
                <div id="evidenceComments"></div>
                <div class="form-group mt-4">
                    <textarea id="newEvidenceComment" class="form-textarea" placeholder="Add a public comment..."></textarea>
                </div>
                <button id="addEvidenceComment" class="btn btn-primary">Add Comment</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="secure-config.js"></script>
    <script src="supabase-storage.js"></script>
    <script src="secure-evidence-manager.js"></script>
    <script src="dashboard-public-viewer.js"></script>
    <script>
        // Create floating particles for dashboard
        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particles.appendChild(particle);
            }
        }
        
        // Tab functionality
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    this.classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                });
            });
            
            // Modal functionality
            const modals = document.querySelectorAll('.modal');
            const closeButtons = document.querySelectorAll('.modal-close');
            
            closeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const modal = this.closest('.modal');
                    modal.classList.remove('active');
                });
            });
            
            // Close modal when clicking outside
            modals.forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            });
        });
        
        // Evidence form functions
        function showEvidenceForm() {
            document.getElementById('evidenceFormContainer').classList.remove('hidden');
        }
        
        function hideEvidenceForm() {
            document.getElementById('evidenceFormContainer').classList.add('hidden');
        }
    </script>
</body>
</html>